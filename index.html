<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scapia FPL Weekly Tracker</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        :root {
            --scapia-orange: #FF6B35;
            --scapia-dark: #1A1A2E;
            --scapia-navy: #16213E;
            --scapia-accent: #0F3460;
            --scapia-gold: #FFD700;
            --scapia-silver: #C0C0C0;
            --scapia-bronze: #CD7F32;
            --success: #48bb78;
            --danger: #e53e3e;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, var(--scapia-dark) 0%, var(--scapia-navy) 50%, var(--scapia-accent) 100%);
            min-height: 100vh;
            color: #fff;
            padding: 15px;
        }
        
        .container {
            max-width: 500px;
            margin: 0 auto;
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .logo {
            font-size: 2.5rem;
            font-weight: 900;
            color: var(--scapia-orange);
            text-shadow: 0 0 20px rgba(255, 107, 53, 0.5);
        }
        
        .tagline {
            color: #a0aec0;
            font-style: italic;
            margin-top: 5px;
        }
        
        .gw-selector {
            display: flex;
            gap: 10px;
            margin-bottom: 25px;
            overflow-x: auto;
            padding: 10px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            scrollbar-width: none; /* Firefox */
        }

        .gw-selector::-webkit-scrollbar {
            display: none; /* Chrome/Safari */
        }
        
        .gw-btn {
            padding: 10px 18px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: #fff;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            white-space: nowrap;
        }
        
        .gw-btn:hover {
            background: rgba(255, 107, 53, 0.2);
            transform: translateY(-2px);
        }
        
        .gw-btn.active {
            background: var(--scapia-orange);
            box-shadow: 0 5px 15px rgba(255, 107, 53, 0.3);
        }
        
        .tabs {
            display: flex;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 4px;
            margin-bottom: 25px;
        }
        
        .tab {
            flex: 1;
            padding: 12px;
            background: transparent;
            border: none;
            color: rgba(255, 255, 255, 0.7);
            font-weight: 600;
            cursor: pointer;
            border-radius: 8px;
            transition: all 0.3s;
        }
        
        .tab.active {
            background: var(--scapia-orange);
            color: white;
        }
        
        .content {
            display: none;
        }
        
        .content.active {
            display: block;
        }
        
        .prize-card {
            background: linear-gradient(135deg, rgba(255, 107, 53, 0.2), rgba(255, 107, 53, 0.1));
            border: 1px solid var(--scapia-orange);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 25px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .prize-card::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255, 107, 53, 0.1), transparent);
            animation: shine 3s infinite;
        }
        
        @keyframes shine {
            0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
            100% { transform: translateX(100%) translateY(100%) rotate(45deg); }
        }
        
        .spotlight-card {
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.15), rgba(255, 107, 53, 0.15));
            border: 2px solid var(--scapia-orange);
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 25px;
            position: relative;
            overflow: hidden;
        }
        
        .spotlight-title {
            font-size: 1.3rem;
            font-weight: 900;
            color: var(--scapia-orange);
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .spotlight-emoji {
            font-size: 2rem;
            animation: bounce 2s infinite;
        }
        
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        
        .spotlight-story {
            font-size: 1rem;
            line-height: 1.6;
            color: #e0e0e0;
        }
        
        .highlight {
            color: var(--scapia-orange);
            font-weight: 700;
        }
        
        .pool-amount {
            font-size: 2.8rem;
            font-weight: 900;
            color: var(--scapia-orange);
            text-shadow: 0 0 25px rgba(255, 107, 53, 0.5);
        }
        
        .pool-info {
            display: flex;
            justify-content: space-around;
            margin: 20px 0;
        }
        
        .info-item {
            text-align: center;
        }
        
        .info-value {
            font-size: 1.3rem;
            font-weight: 700;
        }
        
        .info-label {
            font-size: 0.8rem;
            color: #a0aec0;
        }
        
        .prizes {
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .prize {
            text-align: center;
            padding: 10px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
        }
        
        .prize-emoji {
            font-size: 1.5rem;
        }
        
        .prize-amount {
            font-weight: 700;
            margin-top: 5px;
        }
        
        .leaderboard {
            background: rgba(255, 255, 255, 0.03);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 15px;
        }
        
        .player-row {
            display: flex;
            align-items: center;
            padding: 15px;
            margin-bottom: 10px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            transition: all 0.3s;
            position: relative;
        }
        
        .player-row:hover {
            transform: translateX(5px);
            background: rgba(255, 255, 255, 0.08);
        }
        
        .player-row.winner {
            background: linear-gradient(90deg, rgba(255, 215, 0, 0.2), rgba(255, 107, 53, 0.1));
            border-left: 3px solid var(--scapia-gold);
            animation: glow 2s infinite;
        }
        
        @keyframes glow {
            0%, 100% { box-shadow: 0 0 5px rgba(255, 215, 0, 0.3); }
            50% { box-shadow: 0 0 20px rgba(255, 215, 0, 0.6); }
        }
        
        .trend-indicator {
            margin-left: 8px;
            font-size: 1rem;
            opacity: 0.7;
        }
        
        .trend-up { color: var(--success); }
        .trend-down { color: var(--danger); }
        .trend-same { color: #a0aec0; }
        
        .rank {
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            font-weight: 900;
            margin-right: 15px;
        }
        
        .rank-1 {
            background: linear-gradient(135deg, var(--scapia-gold), #ffed4e);
            color: #000;
        }
        
        .rank-2 {
            background: linear-gradient(135deg, var(--scapia-silver), #d7d7d7);
            color: #000;
        }
        
        .rank-3 {
            background: linear-gradient(135deg, var(--scapia-bronze), #e6ac79);
            color: #000;
        }
        
        .rank-other {
            background: rgba(255, 107, 53, 0.2);
            border: 1px solid var(--scapia-orange);
        }
        
        .player-info {
            flex: 1;
        }
        
        .player-name {
            font-weight: 600;
            font-size: 1.1rem;
        }
        
        .player-captain {
            font-size: 0.8rem;
            color: #a0aec0;
        }
        
        .score-prize {
            text-align: right;
        }
        
        .score {
            font-size: 1.3rem;
            font-weight: 700;
        }
        
        .prize-won {
            color: var(--success);
            font-weight: 600;
        }

        /* Banter section */
        .banter-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-bottom: 25px;
        }
        .banter-card {
            background: linear-gradient(135deg, rgba(255,255,255,0.06), rgba(0,0,0,0.3));
            border-radius: 12px;
            padding: 10px 12px;
            font-size: 0.85rem;
        }
        .banter-title {
            font-weight: 700;
            margin-bottom: 4px;
        }
        .banter-roast .banter-title {
            color: var(--danger);
        }
        .banter-compliment .banter-title {
            color: var(--success);
        }
        
        .standing-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 18px;
            margin-bottom: 12px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .standing-player {
            flex: 1;
        }
        
        .standing-name {
            font-weight: 700;
            font-size: 1.05rem;
            margin-bottom: 4px;
        }

        .manager-nick {
            font-size: 0.85rem;
            color: var(--scapia-orange);
            font-style: italic;
            margin-left: 4px;
        }

        .manager-tagline {
            font-size: 0.8rem;
            color: #cbd5e0;
        }
        
        .standing-stats {
            font-size: 0.85rem;
            color: #a0aec0;
            margin-top: 4px;
        }
        
        .standing-earnings {
            text-align: right;
        }
        
        .net-amount {
            font-size: 1.4rem;
            font-weight: 900;
        }
        
        .positive {
            color: var(--success);
        }
        
        .negative {
            color: var(--danger);
        }
        
        .stats-section {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .stat-title {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--scapia-orange);
            margin-bottom: 15px;
        }
        
        .award {
            padding: 12px;
            background: linear-gradient(135deg, rgba(255, 107, 53, 0.1), rgba(255, 107, 53, 0.05));
            border-radius: 10px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s;
            border-left: 3px solid transparent;
        }
        
        .award:hover {
            transform: translateX(5px);
            border-left-color: var(--scapia-orange);
            background: linear-gradient(135deg, rgba(255, 107, 53, 0.2), rgba(255, 107, 53, 0.1));
        }
        
        .streak-badge {
            display: inline-flex;
            align-items: center;
            gap: 5px;
            padding: 4px 10px;
            background: linear-gradient(135deg, #ff6b35, #ff8c42);
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 700;
            color: #000;
            margin-left: 8px;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        .stat-bar {
            height: 6px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            overflow: hidden;
            margin-top: 5px;
        }
        
        .stat-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--scapia-orange), var(--scapia-gold));
            border-radius: 10px;
            transition: width 1s ease;
        }
        
        .award-info {
            flex: 1;
        }
        
        .award-title {
            font-weight: 700;
            color: var(--scapia-orange);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .award-desc {
            font-size: 0.85rem;
            color: #a0aec0;
            font-style: italic;
        }
        
        .player-story-card {
            background: linear-gradient(135deg, rgba(255, 107, 53, 0.1), rgba(15, 52, 96, 0.2));
            border: 1px solid rgba(255, 107, 53, 0.3);
            border-radius: 15px;
            padding: 18px;
            margin-bottom: 15px;
            transition: all 0.3s;
        }
        
        .player-story-card:hover {
            transform: translateY(-3px);
            border-color: var(--scapia-orange);
            box-shadow: 0 5px 20px rgba(255, 107, 53, 0.2);
        }
        
        .story-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }
        
        .story-player {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--scapia-orange);
        }
        
        .story-emoji {
            font-size: 1.5rem;
        }

        .story-tagline {
            font-size: 0.8rem;
            color: #cbd5e0;
            font-style: italic;
            margin-bottom: 8px;
        }
        
        .story-text {
            font-size: 0.95rem;
            line-height: 1.6;
            color: #e0e0e0;
            font-style: italic;
        }
        
        .award-winner {
            font-weight: 600;
            font-size: 1.1rem;
        }

        /* Rivalries */
        .rivalry-card {
            padding: 12px;
            background: rgba(255,255,255,0.04);
            border-radius: 12px;
            margin-bottom: 10px;
        }
        .rivalry-title {
            font-weight: 700;
            margin-bottom: 4px;
        }
        .rivalry-line {
            font-size: 0.85rem;
            color: #e2e8f0;
        }
        .rivalry-sub {
            font-size: 0.8rem;
            color: #a0aec0;
            margin-top: 4px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="logo">‚úàÔ∏è SCAPIA FPL</div>
            <div class="tagline">GW13: The Week of the Broken Chips</div>
        </div>

        <div class="gw-selector">
            <button class="gw-btn" onclick="showGW(6)">GW 6</button>
            <button class="gw-btn" onclick="showGW(7)">GW 7</button>
            <button class="gw-btn" onclick="showGW(8)">GW 8</button>
            <button class="gw-btn" onclick="showGW(9)">GW 9</button>
            <button class="gw-btn" onclick="showGW(10)">GW 10</button>
            <button class="gw-btn" onclick="showGW(11)">GW 11</button>
            <button class="gw-btn" onclick="showGW(12)">GW 12</button>
            <button class="gw-btn active" onclick="showGW(13)">GW 13</button>
        </div>

        <div class="tabs">
            <button class="tab active" onclick="showTab('battle')">‚öîÔ∏è Battle</button>
            <button class="tab" onclick="showTab('standings')">üèÜ Standings</button>
            <button class="tab" onclick="showTab('stats')">üìä Stats</button>
        </div>

        <div id="battle" class="content active">
            <div id="spotlight"></div>
            
            <div class="prize-card">
                <div class="pool-amount">‚Çπ<span id="poolAmount">1700</span></div>
                <div class="pool-info">
                    <div class="info-item">
                        <div class="info-value" id="playerCount">17</div>
                        <div class="info-label">Warriors</div>
                    </div>
                    <div class="info-item">
                        <div class="info-value">‚Çπ100</div>
                        <div class="info-label">Entry</div>
                    </div>
                    <div class="info-item">
                        <div class="info-value">GW<span id="currentGW">13</span></div>
                        <div class="info-label">Battle</div>
                    </div>
                </div>
                <div class="prizes" id="prizeList"></div>
            </div>

            <div class="leaderboard" id="leaderboard"></div>
            <div id="banter"></div>
        </div>

        <div id="standings" class="content">
            <div id="standingsList"></div>
        </div>

        <div id="stats" class="content">
            <div class="stats-section">
                <div class="stat-title">üìñ Player Stories (GW13 Update)</div>
                <div id="playerStories"></div>
            </div>
            <div class="stats-section">
                <div class="stat-title">ü§∫ Rivalries & Beef</div>
                <div id="rivalries"></div>
            </div>
            <div class="stats-section">
                <div class="stat-title">üèÜ Performance Awards</div>
                <div id="performanceAwards"></div>
            </div>
            <div class="stats-section">
                <div class="stat-title">üòÇ Hall of Fame & Shame</div>
                <div id="funAwards"></div>
            </div>
        </div>
    </div>

    <script>
        // Manager nicknames & taglines
        const managerMeta = {
            'Bharath': {
                nick: 'Heat Check Merchant',
                tagline: 'Currently in the "Ballon d\'Or form" cooling off period (20 pts).'
            },
            'Gokul': {
                nick: 'Volatility FC',
                tagline: 'Bench Boosted his way to 5th place. Efficiency or desperation?'
            },
            'Raghu': {
                nick: 'Narrative Merchant',
                tagline: 'Back in the money. The narrative arc demanded a redemption.'
            },
            'Venky': {
                nick: 'Salah Syndicate',
                tagline: 'Finished 14th this week. The syndicate is taking a short break.'
            },
            'Shashank': {
                nick: 'Differential Ultras',
                tagline: 'Captained Mbeumo for 14 total points. Died on the hill he built.'
            },
            'Shubs': {
                nick: 'Sponsor of the Pot',
                tagline: 'Triple Captained Haaland for 37 points. The generosity returns.'
            },
            'Sukhpal': {
                nick: 'Steady Assassin',
                tagline: 'A rare quiet week (35 pts), but still lurking mid-table.'
            },
            'Neeraj': {
                nick: 'Lightning Starter',
                tagline: 'Stuck in the mud with 27 points. Needs another thunderbolt soon.'
            },
            'Puneet': {
                nick: 'Mr. Consistent',
                tagline: 'Consistently 35 points this week. Not great, not terrible.'
            },
            'Mayank': {
                nick: 'Chip Gambler',
                tagline: 'Didn\'t even need a chip to win GW13. Just pure vibes.'
            },
            'Rounak': {
                nick: 'Late Bloomer',
                tagline: 'Triple Captain fail (39 pts), but still snuck into the money in 7th... wait no, 7th pays nothing.'
            },
            'Sandesh': {
                nick: 'Peak GW3',
                tagline: 'Triple Captained for 27 points. We need to check on him.'
            },
            'Sarjan': {
                nick: 'Painful Pedro Enjoyer',
                tagline: 'Finally! The Pedro patience paid off with a 4th place cash finish.'
            },
            'Sagar': {
                nick: 'Chip Enthusiast',
                tagline: '21 points. The fireworks were duds this week.'
            },
            'Jalaj': {
                nick: 'Loyal Pedro Holder',
                tagline: 'Pedro finally hauled, but the rest of his team stayed on the bus (17 pts).'
            },
            'Arindam': {
                nick: 'Project Long Game',
                tagline: 'The project has launched! First big podium finish (3rd).'
            },
            'Aniruddh': {
                nick: 'Prize Magnet',
                tagline: 'Rare miss for the magnet. 23 points and out of the money.'
            }
        };

        // Game data
        const gameData = {
            2: { players: ['Venky', 'Shubs', 'Bharath', 'Sukhpal', 'Gokul', 'Neeraj', 'Sandesh', 'Shashank', 'Raghu', 'Mayank', 'Puneet'], pool: 1100, prizes: [600, 400, 100], results: [{ name: 'Neeraj', score: 61, captain: 'Salah', prize: 600 }, { name: 'Puneet', score: 56, captain: 'Ekitik√©', prize: 400 }, { name: 'Gokul', score: 53, captain: 'Haaland', prize: 100 }, { name: 'Sukhpal', score: 49, captain: 'Saka', prize: 0 }, { name: 'Shubs', score: 48, captain: 'Salah', prize: 0 }, { name: 'Mayank', score: 42, captain: 'Haaland', prize: 0 }, { name: 'Shashank', score: 42, captain: 'Semenyo', prize: 0 }, { name: 'Raghu', score: 41, captain: 'Haaland', prize: 0 }, { name: 'Bharath', score: 38, captain: 'Salah', prize: 0 }, { name: 'Venky', score: 37, captain: 'Haaland', prize: 0 }, { name: 'Sandesh', score: 29, captain: '√òdegaard', prize: 0 }] },
            3: { players: ['Venky', 'Shubs', 'Bharath', 'Sukhpal', 'Gokul', 'Neeraj', 'Sandesh', 'Shashank', 'Sarjan', 'Raghu', 'Mayank', 'Puneet', 'Rounak', 'Aniruddh'], pool: 1400, prizes: [700, 400, 200, 100], results: [{ name: 'Sandesh', score: 83, captain: 'Jo√£o Pedro', prize: 700 }, { name: 'Shashank', score: 67, captain: 'Mbeumo', prize: 400 }, { name: 'Raghu', score: 64, captain: 'Haaland', prize: 150 }, { name: 'Sarjan', score: 64, captain: 'Jo√£o Pedro', prize: 150 }, { name: 'Gokul', score: 63, captain: 'Haaland', prize: 0 }, { name: 'Bharath', score: 58, captain: 'Jo√£o Pedro', prize: 0 }, { name: 'Venky', score: 54, captain: 'Haaland', prize: 0 }, { name: 'Neeraj', score: 53, captain: 'Jo√£o Pedro', prize: 0 }, { name: 'Mayank', score: 52, captain: 'Haaland', prize: 0 }, { name: 'Sukhpal', score: 44, captain: 'Wood', prize: 0 }, { name: 'Aniruddh', score: 43, captain: 'Wood', prize: 0 }, { name: 'Puneet', score: 40, captain: 'Haaland', prize: 0 }, { name: 'Shubs', score: 37, captain: 'Wood', prize: 0 }, { name: 'Rounak', score: 27, captain: 'Wood', prize: 0 }] },
            4: { players: ['Venky', 'Shubs', 'Bharath', 'Sukhpal', 'Gokul', 'Neeraj', 'Sandesh', 'Shashank', 'Sarjan', 'Raghu', 'Mayank', 'Puneet', 'Rounak', 'Aniruddh', 'Arindam'], pool: 1500, prizes: [700, 450, 250, 100], results: [{ name: 'Venky', score: 77, captain: 'Salah', prize: 700 }, { name: 'Raghu', score: 73, captain: 'Haaland', prize: 450 }, { name: 'Sukhpal', score: 69, captain: 'Haaland', prize: 250 }, { name: 'Puneet', score: 66, captain: 'Haaland', prize: 100 }, { name: 'Arindam', score: 65, captain: 'Haaland', prize: 0 }, { name: 'Sandesh', score: 63, captain: 'Jo√£o Pedro', prize: 0 }, { name: 'Rounak', score: 63, captain: 'Jo√£o Pedro', prize: 0 }, { name: 'Aniruddh', score: 63, captain: 'Haaland', prize: 0 }, { name: 'Neeraj', score: 62, captain: 'Salah', prize: 0 }, { name: 'Sarjan', score: 60, captain: 'Jo√£o Pedro', prize: 0 }, { name: 'Shashank', score: 58, captain: 'Salah', prize: 0 }, { name: 'Shubs', score: 55, captain: 'Salah', prize: 0 }, { name: 'Gokul', score: 53, captain: 'Kudus', prize: 0 }, { name: 'Mayank', score: 46, captain: 'Haaland', prize: 0 }, { name: 'Bharath', score: 41, captain: 'Ekitik√©', prize: 0 }] },
            5: { players: ['Venky', 'Shubs', 'Bharath', 'Sukhpal', 'Gokul', 'Neeraj', 'Sandesh', 'Shashank', 'Sarjan', 'Raghu', 'Mayank', 'Puneet', 'Rounak', 'Aniruddh', 'Arindam'], pool: 1500, prizes: [500, 400, 300, 200, 100], results: [{ name: 'Mayank', score: 63, captain: 'Haaland', prize: 500 }, { name: 'Puneet', score: 61, captain: 'Haaland', prize: 400 }, { name: 'Raghu', score: 60, captain: 'Haaland', prize: 300 }, { name: 'Bharath', score: 57, captain: 'Ekitik√©', prize: 200 }, { name: 'Aniruddh', score: 55, captain: 'Haaland', prize: 100 }, { name: 'Venky', score: 51, captain: 'Salah', prize: 0 }, { name: 'Sukhpal', score: 49, captain: 'Haaland', prize: 0 }, { name: 'Neeraj', score: 47, captain: 'Jo√£o Pedro', prize: 0 }, { name: 'Arindam', score: 47, captain: 'Haaland', prize: 0 }, { name: 'Shashank', score: 44, captain: 'Salah', prize: 0 }, { name: 'Sarjan', score: 44, captain: 'Jo√£o Pedro', prize: 0 }, { name: 'Gokul', score: 43, captain: 'Kudus', prize: 0 }, { name: 'Sandesh', score: 40, captain: 'Jo√£o Pedro', prize: 0 }, { name: 'Shubs', score: 39, captain: 'Salah', prize: 0 }, { name: 'Rounak', score: 38, captain: 'Jo√£o Pedro', prize: 0 }] },
            6: { players: ['Venky', 'Shubs', 'Bharath', 'Sukhpal', 'Gokul', 'Neeraj', 'Sandesh', 'Shashank', 'Sarjan', 'Raghu', 'Mayank', 'Puneet', 'Rounak', 'Aniruddh', 'Arindam', 'Sagar', 'Jalaj'], pool: 1700, prizes: [600, 400, 300, 250, 150], results: [{ name: 'Gokul', score: 68, captain: 'Haaland', prize: 600 }, { name: 'Mayank', score: 65, captain: 'Haaland', prize: 400 }, { name: 'Sukhpal', score: 64, captain: 'Haaland', prize: 300 }, { name: 'Aniruddh', score: 59, captain: 'Haaland', prize: 250 }, { name: 'Rounak', score: 57, captain: 'Haaland', prize: 150 }, { name: 'Raghu', score: 56, captain: 'Haaland', prize: 0 }, { name: 'Shubs', score: 56, captain: 'Haaland', prize: 0 }, { name: 'Sagar', score: 55, captain: 'Haaland', prize: 0 }, { name: 'Puneet', score: 49, captain: 'Haaland', prize: 0 }, { name: 'Venky', score: 48, captain: 'Haaland', prize: 0 }, { name: 'Sandesh', score: 46, captain: 'Jo√£o Pedro', prize: 0 }, { name: 'Shashank', score: 39, captain: 'Salah', prize: 0 }, { name: 'Sarjan', score: 29, captain: 'Jo√£o Pedro', prize: 0 }, { name: 'Neeraj', score: 27, captain: 'Richarlison', prize: 0 }, { name: 'Jalaj', score: 26, captain: 'Jo√£o Pedro', prize: 0 }, { name: 'Bharath', score: 24, captain: 'Jo√£o Pedro', prize: 0 }, { name: 'Arindam', score: 18, captain: 'Haaland', prize: 0 }] },
            7: { players: ['Venky', 'Shubs', 'Bharath', 'Sukhpal', 'Gokul', 'Neeraj', 'Sandesh', 'Shashank', 'Sarjan', 'Raghu', 'Mayank', 'Puneet', 'Rounak', 'Aniruddh', 'Arindam', 'Sagar', 'Jalaj'], pool: 1700, prizes: [600, 400, 300, 250, 150], results: [{ name: 'Gokul', score: 95, captain: 'Haaland', prize: 600 }, { name: 'Bharath', score: 83, captain: 'Haaland', prize: 400 }, { name: 'Rounak', score: 77, captain: 'Haaland', prize: 300 }, { name: 'Neeraj', score: 74, captain: 'Haaland', prize: 200 }, { name: 'Aniruddh', score: 74, captain: 'Haaland', prize: 200 }, { name: 'Puneet', score: 71, captain: 'Haaland', prize: 0 }, { name: 'Sukhpal', score: 71, captain: 'Haaland', prize: 0 }, { name: 'Arindam', score: 70, captain: 'Haaland', prize: 0 }, { name: 'Shubs', score: 69, captain: 'Haaland', prize: 0 }, { name: 'Shashank', score: 68, captain: 'Mbeumo', prize: 0 }, { name: 'Mayank', score: 66, captain: 'Haaland', prize: 0 }, { name: 'Sagar', score: 65, captain: 'Haaland', prize: 0 }, { name: 'Venky', score: 55, captain: 'Haaland', prize: 0 }, { name: 'Raghu', score: 50, captain: 'Haaland', prize: 0 }, { name: 'Jalaj', score: 48, captain: 'Jo√£o Pedro', prize: 0 }, { name: 'Sandesh', score: 47, captain: 'Jo√£o Pedro', prize: 0 }, { name: 'Sarjan', score: 41, captain: 'Jo√£o Pedro', prize: 0 }] },
            8: { players: ['Venky', 'Shubs', 'Bharath', 'Sukhpal', 'Gokul', 'Neeraj', 'Sandesh', 'Shashank', 'Sarjan', 'Raghu', 'Mayank', 'Puneet', 'Rounak', 'Aniruddh', 'Arindam', 'Sagar', 'Jalaj'], pool: 1700, prizes: [600, 400, 300, 250, 150], results: [{ name: 'Bharath', score: 90, captain: 'Haaland', prize: 600 }, { name: 'Sukhpal', score: 81, captain: 'Haaland', prize: 400 }, { name: 'Mayank', score: 80, captain: 'Haaland (TC)', prize: 275 }, { name: 'Gokul', score: 80, captain: 'Haaland', prize: 275 }, { name: 'Aniruddh', score: 72, captain: 'Haaland', prize: 150 }, { name: 'Neeraj', score: 69, captain: 'Haaland', prize: 0 }, { name: 'Rounak', score: 68, captain: 'Haaland', prize: 0 }, { name: 'Sandesh', score: 68, captain: 'Jo√£o Pedro (FH)', prize: 0 }, { name: 'Shubs', score: 64, captain: 'Haaland', prize: 0 }, { name: 'Raghu', score: 63, captain: 'Haaland (WC)', prize: 0 }, { name: 'Puneet', score: 60, captain: 'Haaland', prize: 0 }, { name: 'Venky', score: 54, captain: 'Haaland', prize: 0 }, { name: 'Arindam', score: 50, captain: 'Haaland', prize: 0 }, { name: 'Shashank', score: 46, captain: 'Semenyo', prize: 0 }, { name: 'Sagar', score: 44, captain: 'Haaland', prize: 0 }, { name: 'Sarjan', score: 42, captain: 'Jo√£o Pedro', prize: 0 }, { name: 'Jalaj', score: 37, captain: 'Jo√£o Pedro', prize: 0 }] },
            9: { players: ['Venky', 'Shubs', 'Bharath', 'Sukhpal', 'Gokul', 'Neeraj', 'Sandesh', 'Shashank', 'Sarjan', 'Raghu', 'Mayank', 'Puneet', 'Rounak', 'Aniruddh', 'Arindam', 'Sagar', 'Jalaj'], pool: 1700, prizes: [600, 400, 300, 250, 150], results: [{ name: 'Shashank', score: 69, captain: 'Mbeumo', prize: 600 }, { name: 'Bharath', score: 68, captain: 'Jo√£o Pedro', prize: 400 }, { name: 'Raghu', score: 67, captain: 'Haaland (WC)', prize: 300 }, { name: 'Sukhpal', score: 61, captain: 'Haaland', prize: 250 }, { name: 'Venky', score: 57, captain: 'Haaland', prize: 50 }, { name: 'Sagar', score: 57, captain: 'Haaland', prize: 50 }, { name: 'Jalaj', score: 57, captain: 'Jo√£o Pedro', prize: 50 }, { name: 'Arindam', score: 48, captain: 'Haaland', prize: 0 }, { name: 'Puneet', score: 45, captain: 'Haaland', prize: 0 }, { name: 'Rounak', score: 44, captain: 'Haaland', prize: 0 }, { name: 'Sandesh', score: 44, captain: 'Jo√£o Pedro', prize: 0 }, { name: 'Mayank', score: 43, captain: 'Semenyo', prize: 0 }, { name: 'Neeraj', score: 37, captain: 'Haaland', prize: 0 }, { name: 'Sarjan', score: 37, captain: 'Jo√£o Pedro', prize: 0 }, { name: 'Shubs', score: 36, captain: 'Haaland (WC)', prize: 0 }, { name: 'Aniruddh', score: 36, captain: 'Semenyo', prize: 0 }, { name: 'Gokul', score: 31, captain: 'Haaland', prize: 0 }] },
            10: { players: ['Shashank','Bharath','Raghu','Sukhpal','Venky','Sagar','Jalaj','Arindam','Puneet','Rounak','Sandesh','Mayank','Neeraj','Sarjan','Shubs','Aniruddh','Gokul'], pool: 1700, prizes: [600, 400, 300, 250, 150], results: [{ name: 'Sukhpal', score: 93, captain: 'Haaland', prize: 600 }, { name: 'Neeraj', score: 89, captain: 'Haaland', prize: 400 }, { name: 'Shubs', score: 83, captain: 'Haaland', prize: 300 }, { name: 'Bharath', score: 82, captain: 'Haaland (BB1)', prize: 250 }, { name: 'Sagar', score: 81, captain: 'Haaland (FH1)', prize: 150 }, { name: 'Rounak', score: 78, captain: 'Haaland', prize: 0 }, { name: 'Mayank', score: 73, captain: 'Gabriel', prize: 0 }, { name: 'Gokul', score: 73, captain: 'Haaland', prize: 0 }, { name: 'Puneet', score: 72, captain: 'Haaland', prize: 0 }, { name: 'Raghu', score: 67, captain: 'Haaland', prize: 0 }, { name: 'Shashank', score: 66, captain: 'Mbeumo', prize: 0 }, { name: 'Jalaj', score: 64, captain: 'Jo√£o Pedro', prize: 0 }, { name: 'Sandesh', score: 62, captain: 'Jo√£o Pedro', prize: 0 }, { name: 'Venky', score: 60, captain: 'Haaland', prize: 0 }, { name: 'Aniruddh', score: 56, captain: 'Haaland', prize: 0 }, { name: 'Arindam', score: 52, captain: 'Haaland', prize: 0 }, { name: 'Sarjan', score: 43, captain: 'Jo√£o Pedro', prize: 0 }] },
            11: { players: ['Shashank','Bharath','Raghu','Sukhpal','Venky','Sagar','Jalaj','Arindam','Puneet','Rounak','Sandesh','Mayank','Neeraj','Sarjan','Shubs','Aniruddh','Gokul'], pool: 1700, prizes: [600, 400, 300, 250, 150], results: [{ name: 'Aniruddh', score: 49, captain: 'Haaland', prize: 600 }, { name: 'Gokul', score: 48, captain: 'Haaland', prize: 400 }, { name: 'Venky', score: 46, captain: 'Haaland', prize: 300 }, { name: 'Puneet', score: 45, captain: 'Haaland', prize: 250 }, { name: 'Jalaj', score: 43, captain: 'Jo√£o Pedro', prize: 50 }, { name: 'Arindam', score: 43, captain: 'Haaland', prize: 50 }, { name: 'Sarjan', score: 43, captain: 'Jo√£o Pedro', prize: 50 }, { name: 'Sandesh', score: 42, captain: 'Jo√£o Pedro', prize: 0 }, { name: 'Shubs', score: 42, captain: 'Gabriel', prize: 0 }, { name: 'Raghu', score: 40, captain: 'Haaland', prize: 0 }, { name: 'Neeraj', score: 39, captain: 'Semenyo', prize: 0 }, { name: 'Sukhpal', score: 38, captain: 'Haaland', prize: 0 }, { name: 'Mayank', score: 36, captain: 'Caicedo', prize: 0 }, { name: 'Bharath', score: 35, captain: 'Enzo', prize: 0 }, { name: 'Shashank', score: 34, captain: 'Caicedo', prize: 0 }, { name: 'Rounak', score: 34, captain: 'Haaland', prize: 0 }, { name: 'Sagar', score: 29, captain: 'Haaland', prize: 0 }] },
            12: { players: ['Shashank','Bharath','Raghu','Sukhpal','Venky','Sagar','Jalaj','Arindam','Puneet','Rounak','Sandesh','Mayank','Neeraj','Sarjan','Shubs','Aniruddh','Gokul'], pool: 1700, prizes: [600, 400, 300, 250, 150], results: [{ name: 'Shubs', score: 61, captain: 'Haaland', prize: 600 }, { name: 'Bharath', score: 60, captain: 'Haaland', prize: 400 }, { name: 'Raghu', score: 50, captain: 'Haaland', prize: 300 }, { name: 'Rounak', score: 48, captain: 'Haaland (FH1)', prize: 250 }, { name: 'Neeraj', score: 47, captain: 'Haaland', prize: 150 }, { name: 'Gokul', score: 46, captain: 'Haaland', prize: 0 }, { name: 'Sandesh', score: 46, captain: 'Haaland (BB1)', prize: 0 }, { name: 'Sukhpal', score: 45, captain: 'Haaland', prize: 0 }, { name: 'Aniruddh', score: 45, captain: 'Haaland', prize: 0 }, { name: 'Sarjan', score: 39, captain: 'Jo√£o Pedro', prize: 0 }, { name: 'Puneet', score: 38, captain: 'Haaland', prize: 0 }, { name: 'Venky', score: 35, captain: 'Haaland (TC1)', prize: 0 }, { name: 'Shashank', score: 34, captain: 'Salah', prize: 0 }, { name: 'Arindam', score: 33, captain: 'Haaland', prize: 0 }, { name: 'Sagar', score: 32, captain: 'Haaland (TC1)', prize: 0 }, { name: 'Mayank', score: 30, captain: 'Mateta', prize: 0 }, { name: 'Jalaj', score: 27, captain: 'Jo√£o Pedro', prize: 0 }] },
            13: { 
                players: ['Shashank','Bharath','Raghu','Sukhpal','Venky','Sagar','Jalaj','Arindam','Puneet','Rounak','Sandesh','Mayank','Neeraj','Sarjan','Shubs','Aniruddh','Gokul'], 
                pool: 1700, 
                prizes: [600, 400, 300, 250, 150], 
                results: [
                    { name: 'Mayank', score: 47, captain: 'Haaland', prize: 600 },
                    { name: 'Raghu', score: 46, captain: 'Haaland', prize: 400 },
                    { name: 'Arindam', score: 44, captain: 'Haaland', prize: 300 },
                    { name: 'Sarjan', score: 41, captain: 'Jo√£o Pedro', prize: 250 },
                    { name: 'Gokul', score: 40, captain: 'Haaland (BB1)', prize: 150 },
                    { name: 'Rounak', score: 39, captain: 'Haaland (TC1)', prize: 0 },
                    { name: 'Shubs', score: 37, captain: 'Haaland (TC1)', prize: 0 },
                    { name: 'Sukhpal', score: 35, captain: 'Haaland', prize: 0 },
                    { name: 'Puneet', score: 35, captain: 'Haaland', prize: 0 },
                    { name: 'Venky', score: 30, captain: 'Haaland', prize: 0 },
                    { name: 'Neeraj', score: 27, captain: 'Haaland', prize: 0 },
                    { name: 'Sandesh', score: 27, captain: 'Haaland (TC1)', prize: 0 },
                    { name: 'Aniruddh', score: 23, captain: 'Haaland', prize: 0 },
                    { name: 'Sagar', score: 21, captain: 'Haaland', prize: 0 },
                    { name: 'Bharath', score: 20, captain: 'Haaland', prize: 0 },
                    { name: 'Jalaj', score: 17, captain: 'Jo√£o Pedro', prize: 0 },
                    { name: 'Shashank', score: 14, captain: 'Mbeumo', prize: 0 }
                ] 
            }
        };

        let currentGW = 13;

        function showGW(gw) {
            currentGW = gw;
            document.querySelectorAll('.gw-btn').forEach(btn => btn.classList.remove('active'));
            if (event && event.target) {
                event.target.classList.add('active');
            }
            updateBattle();
        }

        function showTab(tab) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            if (event && event.target) {
                event.target.classList.add('active');
            }
            
            document.querySelectorAll('.content').forEach(c => c.classList.remove('active'));
            document.getElementById(tab).classList.add('active');
            
            if (tab === 'standings') updateStandings();
            if (tab === 'stats') {
                updateStats();
                updateRivalries();
            }
        }

        function updateBattle() {
            const data = gameData[currentGW];
            
            const spotlight = generateSpotlight(currentGW);
            document.getElementById('spotlight').innerHTML = spotlight;
            
            document.getElementById('poolAmount').textContent = data.pool;
            document.getElementById('playerCount').textContent = data.players.length;
            document.getElementById('currentGW').textContent = currentGW;
            
            const medals = ['ü•á', 'ü•à', 'ü•â', 'üéñÔ∏è', 'üèÖ'];
            const prizeHTML = data.prizes.map((prize, i) => `
                <div class="prize">
                    <div class="prize-emoji">${medals[i]}</div>
                    <div class="prize-amount">‚Çπ${prize}</div>
                </div>
            `).join('');
            document.getElementById('prizeList').innerHTML = prizeHTML;
            
            const prevGW = gameData[currentGW - 1];
            const prevPositions = {};
            if (prevGW) {
                prevGW.results.forEach((player, idx) => {
                    prevPositions[player.name] = idx + 1;
                });
            }
            
            const leaderboardHTML = data.results.map((player, i) => {
                const rank = i + 1;
                let rankClass = rank <= 3 ? `rank-${rank}` : (player.prize > 0 ? 'rank-other' : '');
                const medals = ['ü•á', 'ü•à', 'ü•â', '4', '5'];
                let rankDisplay = rank <= 5 && player.prize > 0 ? (medals[rank-1] || rank) : rank;
                
                let trendArrow = '';
                if (prevPositions[player.name]) {
                    const prevRank = prevPositions[player.name];
                    if (prevRank > rank) {
                        trendArrow = '<span class="trend-indicator trend-up">üìà</span>';
                    } else if (prevRank < rank) {
                        trendArrow = '<span class="trend-indicator trend-down">üìâ</span>';
                    } else {
                        trendArrow = '<span class="trend-indicator trend-same">‚û°Ô∏è</span>';
                    }
                }
                
                const winnerClass = player.prize > 0 ? 'winner' : '';
                
                return `
                    <div class="player-row ${winnerClass}">
                        <div class="rank ${rankClass}">${rankDisplay}</div>
                        <div class="player-info">
                            <div class="player-name">${player.name}${trendArrow}</div>
                            <div class="player-captain">‚ö° ${player.captain}</div>
                        </div>
                        <div class="score-prize">
                            <div class="score">${player.score}</div>
                            ${player.prize > 0 ? `<div class="prize-won">+‚Çπ${player.prize}</div>` : ''}
                        </div>
                    </div>
                `;
            }).join('');
            document.getElementById('leaderboard').innerHTML = leaderboardHTML;

            updateBanter(currentGW);
        }
        
        function generateSpotlight(gw) {
            const stories = {
                2: { emoji: '‚ö°', title: 'Neeraj Wins the Opener!', story: '<span class="highlight">Neeraj</span> claims first blood with 61 points and a Salah captain as the Scapia mini-league battle begins.' },
                3: { emoji: 'üåä', title: 'Sandesh\'s Massive Haul!', story: '<span class="highlight">Sandesh</span> explodes for 83 with a Jo√£o Pedro captain. First week with 4 prizes as more warriors join the arena.' },
                4: { emoji: 'üöÄ', title: 'Venky\'s Salah Masterclass!', story: '<span class="highlight">Venky</span> banks a big win with 77 thanks to the Salah differential while four managers share the spoils.' },
                5: { emoji: 'üí∞', title: 'Five-Way Prize Split!', story: '<span class="highlight">Mayank</span> tops the week, but five different managers walk away with cash. Most balanced battle so far.' },
                6: { emoji: 'üéØ', title: 'Gokul Rises to the Top!', story: '<span class="highlight">Gokul</span> takes his first win with 68 as the Haaland captaincy continues to dominate the payout zone.' },
                7: { emoji: 'üëë', title: 'Gokul Goes Nuclear!', story: '<span class="highlight">Gokul</span> detonates a 95-pointer. <span class="highlight">Bharath</span> rebounds from a 24-pointer to finish 2nd and kick-start a hot streak.' },
                8: { emoji: 'üî•', title: 'Bharath\'s Back-to-Back Domination!', story: '<span class="highlight">Bharath</span> follows up his surge with a huge 90 and another win. Triple-captain <span class="highlight">Mayank</span> and <span class="highlight">Gokul</span> share 3rd.' },
                9: { emoji: 'ü¶Ñ', title: 'The Differential King Strikes!', story: '<span class="highlight">Shashank</span> finally cashes in with Mbeumo captain and takes the week. <span class="highlight">Bharath</span> completes a crazy 1st‚Üí1st‚Üí2nd run.' },
                10: { emoji: 'üö®', title: 'Sukhpal Drops a Monster!', story: '<span class="highlight">Sukhpal</span> smashes 93 with Haaland to take a statement win. <span class="highlight">Neeraj</span> and <span class="highlight">Shubs</span> round off the podium.' },
                11: { emoji: 'üßä', title: 'Low-Scoring Chaos Week!', story: '<span class="highlight">Aniruddh</span> grinds out a 49-point win in a cold, low-scoring gameweek. <span class="highlight">Gokul</span> and <span class="highlight">Venky</span> join him on the podium.' },
                12: { emoji: 'üéÑ', title: 'Shubs Wins the Festive GW!', story: '<span class="highlight">Shubs</span> finally tops the pile with 61 and a simple Haaland captain, nudging <span class="highlight">Bharath</span> into 2nd.' },
                13: { emoji: 'ü§°', title: 'The Triple Captain Disaster!', story: '<span class="highlight">Mayank</span> wins with just 47 points in a brutal week. <span class="highlight">Rounak</span>, <span class="highlight">Shubs</span>, and <span class="highlight">Sandesh</span> all wasted their Triple Captain chips and failed to even crack the top 5! <span class="highlight">Arindam</span> grabs his first podium.' }
            };
            
            const story = stories[gw] || { emoji: 'üéÆ', title: 'The Battle Continues!', story: 'Another spicy gameweek in the books.' };
            
            return `
                <div class="spotlight-card">
                    <div class="spotlight-title">
                        <span class="spotlight-emoji">${story.emoji}</span>
                        ${story.title}
                    </div>
                    <div class="spotlight-story">${story.story}</div>
                </div>
            `;
        }

        // Roast & Compliment of the week
        function updateBanter(gw) {
            const data = gameData[gw];
            if (!data) return;

            const results = data.results;
            const lowest = results[results.length - 1];
            const nonPrize = results.filter(p => p.prize === 0);
            let bestNonPrize = null;
            if (nonPrize.length > 0) {
                bestNonPrize = nonPrize.reduce((best, cur) => (cur.score > best.score ? cur : best), nonPrize[0]);
            }

            let roastText = '';
            let complimentText = '';

            if (lowest) {
                const meta = managerMeta[lowest.name] || {};
                roastText = `${lowest.name}${meta.nick ? ` (${meta.nick})` : ''} hit absolute rock bottom with ${lowest.score} points. <b>${lowest.captain}</b> captain was a crime against FPL.`;
            }

            if (bestNonPrize) {
                const meta = managerMeta[bestNonPrize.name] || {};
                complimentText = `${bestNonPrize.name}${meta.nick ? ` (${meta.nick})` : ''} scored ${bestNonPrize.score} points‚Äîmore than 3 Triple Captainers!‚Äîbut still won <b>‚Çπ0</b>. Tragic hero.`;
            }
            
            // Special Roast for GW13
            if(gw === 13) {
                 roastText = "Shashank captained Mbeumo for 14 total points while 3 managers wasted their Triple Captain chips on blankers. The Hall of Shame is crowded this week.";
            }

            document.getElementById('banter').innerHTML = `
                <div class="banter-section">
                    <div class="banter-card banter-roast">
                        <div class="banter-title">üî• Roast of the Week</div>
                        <div class="banter-text">${roastText}</div>
                    </div>
                    <div class="banter-card banter-compliment">
                        <div class="banter-title">üíö Clutch with No Cash</div>
                        <div class="banter-text">${complimentText}</div>
                    </div>
                </div>
            `;
        }

        function updateStandings() {
            const earnings = {};
            
            Object.keys(gameData).forEach(gwNum => {
                const gw = gameData[gwNum];
                gw.results.forEach(result => {
                    if (gw.players.includes(result.name)) {
                        if (!earnings[result.name]) {
                            earnings[result.name] = { won: 0, played: 0, currentStreak: 0, topStreak: 0 };
                        }
                        earnings[result.name].played++;
                        if (result.prize > 0) {
                            earnings[result.name].won += result.prize;
                            earnings[result.name].currentStreak++;
                            earnings[result.name].topStreak = Math.max(
                                earnings[result.name].topStreak,
                                earnings[result.name].currentStreak
                            );
                        } else {
                            earnings[result.name].currentStreak = 0;
                        }
                    }
                });
            });
            
            const standings = Object.entries(earnings).map(([name, data]) => ({
                name,
                net: data.won - data.played * 100,
                won: data.won,
                played: data.played,
                streak: data.currentStreak,
                topStreak: data.topStreak
            })).sort((a, b) => b.net - a.net);
            
            const standingsHTML = standings.map(player => {
                const streakBadge = player.streak >= 2 
                    ? `<span class="streak-badge">üî• ${player.streak}x streak</span>` 
                    : '';
                
                return `
                    <div class="standing-card">
                        <div class="standing-player">
                            <div class="standing-name">
                                ${player.name}
                                ${streakBadge}
                            </div>
                            <div class="standing-stats">
                                üéÆ ${player.played} games | üí∞ ‚Çπ${player.played * 100} entry | Winnings: ‚Çπ${player.won}
                            </div>
                        </div>
                        <div class="standing-earnings">
                            <div class="net-amount ${player.net >= 0 ? 'positive' : 'negative'}">
                                ${player.net >= 0 ? '+' : '-'}‚Çπ${Math.abs(player.net)}
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
            document.getElementById('standingsList').innerHTML = standingsHTML;
        }

        function updateStats() {
            const playerStats = {};
            Object.values(gameData).forEach(gw => {
                gw.results.forEach((result, index) => {
                    if (gw.players.includes(result.name)) {
                        if (!playerStats[result.name]) {
                            playerStats[result.name] = {
                                games: 0,
                                wins: 0,
                                podiums: 0,
                                scores: [],
                                positions: [],
                                earnings: 0
                            };
                        }
                        const stats = playerStats[result.name];
                        stats.games++;
                        stats.scores.push(result.score);
                        stats.positions.push(index + 1);
                        if (index === 0) stats.wins++;
                        if (index < 3) stats.podiums++;
                        if (result.prize > 0) stats.earnings += result.prize;
                    }
                });
            });
            
            const playerStories = {
                'Bharath': { emoji: '‚ùÑÔ∏è', story: `Went from "unbeatable god" to "frozen statue" real quick. Scored 20 points in GW13 to remind everyone he is human. Still a net-positive giant, but the heat check failed spectacularly this week.` },
                'Gokul': { emoji: 'üé¢', story: `The volatility king. Bench Boosted in GW13 to scrape a 5th place finish. He'll take the ‚Çπ150, but let's be honest, that chip usage was... interesting. Currently sitting pretty high in the net standings.` },
                'Shashank': { emoji: 'üìâ', story: `The Differential Zealot hit a new low. Captained Mbeumo for a grand total of 14 points in GW13. It's not just a bad week; it's a protest against the template. The protest failed.` },
                'Sukhpal': { emoji: 'üòê', story: `Dropped a respectable but boring 35 in GW13. After that monster GW10 win, he's settled into a rhythm of lurking in mid-table, waiting for Haaland to haul again.` },
                'Raghu': { emoji: 'ü•à', story: `The "Narrative Merchant" is officially back! After a mid-season wobble, he secures 2nd place in GW13. The story arc demanded a redemption, and Raghu delivered.` },
                'Neeraj': { emoji: 'üê¢', story: `Started the season fast, now moving at a glacial pace. 27 points in GW13 keeps him firmly in the "donated to the pot" category for another week.` },
                'Aniruddh': { emoji: 'üí∏', story: `Usually a prize magnet, but GW13 repelled him hard. 23 points is his lowest score in ages. The steady income stream has temporarily dried up.` },
                'Rounak': { emoji: 'üöÆ', story: `Triple Captain on Haaland... for 39 points. And finished 6th. The "Late Bloomer" just bloomed into a faceplant. Tragedy.` },
                'Mayank': { emoji: 'üé∞', story: `The Chip Gambler won GW13 without even using a chip! A low-scoring 47 was enough to take the top prize. Proving you don't need strategy when you have luck.` },
                'Sandesh': { emoji: 'üíÄ', story: `Triple Captained for 27 points. I repeat, Triple Captained for 27 points. The GW3 glory days feel like a distant memory.` },
                'Puneet': { emoji: 'üòê', story: `Mr. Consistent lived up to his name with a bang-average 35. He's always there, lurking, never quite winning big, but never imploding like Shashank.` },
                'Venky': { emoji: 'üí§', story: `Finished 14th in GW13. The Salah Syndicate is on a sabbatical. The graph is currently pointing towards "donation mode."` },
                'Shubs': { emoji: 'üè•', story: `Another Triple Captain casualty. 37 points. He went from winning GW12 to sponsoring the pot again in record time.` },
                'Sagar': { emoji: 'üéÜ', story: `21 points. The fireworks were wet. A quiet disaster of a week for the chip enthusiast.` },
                'Jalaj': { emoji: 'üöå', story: `Jo√£o Pedro returned, but the rest of Jalaj's team stayed on the bus. 17 points is... tough.` },
                'Sarjan': { emoji: 'üôå', story: `The patience paid off! Finally, a cash finish (4th) thanks to sticking with Jo√£o Pedro while everyone else panicked.` },
                'Arindam': { emoji: 'ü•â', story: `The "Project" has liftoff! Arindam secures his first-ever podium finish (3rd) in GW13. The apprentice is becoming a master.` }
            };
            
            const storiesHTML = Object.entries(playerStories)
                .filter(([name]) => playerStats[name] && playerStats[name].games >= 5)
                .sort((a, b) => {
                    const netA = playerStats[a[0]].earnings - playerStats[a[0]].games * 100;
                    const netB = playerStats[b[0]].earnings - playerStats[b[0]].games * 100;
                    return netB - netA;
                })
                .map(([name, story]) => {
                    const meta = managerMeta[name] || {};
                    return `
                        <div class="player-story-card">
                            <div class="story-header">
                                <div class="story-player">
                                    ${name}
                                    ${meta.nick ? `<span class="manager-nick">‚Äú${meta.nick}‚Äù</span>` : ''}
                                </div>
                                <div class="story-emoji">${story.emoji}</div>
                            </div>
                            ${meta.tagline ? `<div class="story-tagline">${meta.tagline}</div>` : ''}
                            <div class="story-text">${story.story}</div>
                        </div>
                    `;
                }).join('');
            
            document.getElementById('playerStories').innerHTML = storiesHTML;
            
            const entries = Object.entries(playerStats);
            if (!entries.length) return;
            
            const mostWins = [...entries].sort((a, b) => b[1].wins - a[1].wins)[0];
            const peakPerformance = [...entries].map(([name, stats]) => {
                return [name, { ...stats, maxScore: Math.max(...stats.scores) }];
            }).sort((a, b) => b[1].maxScore - a[1].maxScore)[0];
            const mostConsistent = [...entries]
                .filter(([_, s]) => s.games >= 5)
                .map(([name, stats]) => {
                    const avg = stats.positions.reduce((a, b) => a + b, 0) / stats.positions.length;
                    const variance = stats.positions.reduce((sum, pos) => sum + Math.pow(pos - avg, 2), 0) / stats.positions.length;
                    return [name, { ...stats, variance }];
                }).sort((a, b) => a[1].variance - b[1].variance)[0];
            const prizeMagnet = [...entries]
                .filter(([_, s]) => s.games >= 5)
                .map(([name, stats]) => {
                    const prizeCount = stats.positions.filter(p => p <= 5).length;
                    return [name, { ...stats, prizeCount }];
                }).sort((a, b) => b[1].prizeCount - a[1].prizeCount)[0];
            const formHorse = [...entries]
                .filter(([_, s]) => s.games >= 3)
                .map(([name, stats]) => {
                    const recent3 = stats.positions.slice(-3);
                    const avgRecent = recent3.reduce((a, b) => a + b, 0) / recent3.length;
                    return [name, { ...stats, avgRecent }];
                }).sort((a, b) => a[1].avgRecent - b[1].avgRecent)[0];
            
            const performanceAwards = [
                { title: 'Season Win Leader', emoji: 'üèÖ', desc: 'Most individual gameweek wins so far.', winner: mostWins },
                { title: 'Peak Performance', emoji: '‚õ∞Ô∏è', desc: 'Highest single-gameweek score in the league.', winner: peakPerformance },
                { title: 'Mr. Reliable', emoji: 'üéØ', desc: 'Most consistent positions across all entries.', winner: mostConsistent },
                { title: 'Prize Magnet', emoji: 'üéñÔ∏è', desc: 'Most frequent top-5 appearances.', winner: prizeMagnet },
                { title: 'Form Horse', emoji: 'üêé', desc: 'Best average rank over the last three entries.', winner: formHorse }
            ];
            
            const generousDonor = [...entries]
                .filter(([_, s]) => s.earnings === 0 && s.games >= 5)
                .sort((a, b) => b[1].games - a[1].games)[0];
            const wildcardWarrior = [...entries]
                .filter(([_, s]) => s.games >= 5)
                .map(([name, stats]) => {
                    const swings = [];
                    for (let i = 1; i < stats.positions.length; i++) {
                        swings.push(Math.abs(stats.positions[i] - stats.positions[i - 1]));
                    }
                    const avgSwing = swings.reduce((a, b) => a + b, 0) / swings.length;
                    return [name, { ...stats, avgSwing }];
                }).sort((a, b) => b[1].avgSwing - a[1].avgSwing)[0];
            const resurrection = [...entries]
                .filter(([_, s]) => s.games >= 6)
                .map(([name, stats]) => {
                    const worst = Math.max(...stats.positions);
                    const worstIndex = stats.positions.lastIndexOf(worst);
                    if (worstIndex >= stats.positions.length - 2) {
                        return [name, { ...stats, score: 0 }];
                    }
                    const afterWorst = stats.positions.slice(worstIndex + 1);
                    const improvement = worst - (afterWorst.reduce((a, b) => a + b, 0) / afterWorst.length);
                    return [name, { ...stats, score: improvement }];
                }).sort((a, b) => b[1].score - a[1].score)[0];
            const earlyPeak = [...entries]
                .filter(([_, s]) => s.games >= 5)
                .map(([name, stats]) => {
                    const bestPos = Math.min(...stats.positions);
                    const bestIndex = stats.positions.indexOf(bestPos);
                    if (bestIndex >= stats.positions.length - 2) {
                        return [name, { ...stats, score: 0 }];
                    }
                    const afterBest = stats.positions.slice(bestIndex + 1);
                    const decline = afterBest.reduce((a, b) => a + b, 0) / afterBest.length - bestPos;
                    return [name, { ...stats, score: decline }];
                }).sort((a, b) => b[1].score - a[1].score)[0];
            const lateBloomer = [...entries]
                .filter(([_, s]) => s.games >= 5)
                .map(([name, stats]) => {
                    const firstHalf = stats.positions.slice(0, Math.floor(stats.games / 2));
                    const secondHalf = stats.positions.slice(Math.floor(stats.games / 2));
                    const improvement = (firstHalf.reduce((a, b) => a + b, 0) / firstHalf.length) - 
                                        (secondHalf.reduce((a, b) => a + b, 0) / secondHalf.length);
                    return [name, { ...stats, improvement }];
                }).sort((a, b) => b[1].improvement - a[1].improvement)[0];
            
            const funAwards = [
                { title: 'Phoenix Rising', emoji: 'üî•', desc: 'Biggest comeback after a disaster week.', winner: resurrection },
                { title: 'Early Peak Syndrome', emoji: 'üí´', desc: 'Massive early high followed by a long comedown.', winner: earlyPeak },
                { title: 'Late Bloomer', emoji: 'üå±', desc: 'Started slow, heating up over time.', winner: lateBloomer },
                { title: 'Generous Donor', emoji: 'üí∏', desc: 'Most entries with no winnings so far.', winner: generousDonor },
                { title: 'Wildcard Warrior', emoji: 'üé∞', desc: 'Most dramatic week-to-week rank swings.', winner: wildcardWarrior }
            ];
            
            const performanceHTML = performanceAwards
                .filter(a => a.winner && a.winner[1])
                .map(award => {
                    const [name, stats] = award.winner;
                    let statDetail = '';
                    if (award.title === 'Season Win Leader') {
                        statDetail = `<div class="stat-bar"><div class="stat-fill" style="width: ${(stats.wins / stats.games) * 100}%"></div></div>`;
                    }
                    if (award.title === 'Prize Magnet') {
                        statDetail = `<div class="stat-bar"><div class="stat-fill" style="width: ${(stats.prizeCount / stats.games) * 100}%"></div></div>`;
                    }
                    return `
                        <div class="award">
                            <div class="award-info">
                                <div class="award-title">${award.emoji} ${award.title}</div>
                                <div class="award-desc">${award.desc}</div>
                                ${statDetail}
                            </div>
                            <div class="award-winner">${name}</div>
                        </div>
                    `;
                }).join('');
            
            const funHTML = funAwards
                .filter(a => a.winner && a.winner[1])
                .map(award => {
                    const [name] = award.winner;
                    return `
                        <div class="award">
                            <div class="award-info">
                                <div class="award-title">${award.emoji} ${award.title}</div>
                                <div class="award-desc">${award.desc}</div>
                            </div>
                            <div class="award-winner">${name}</div>
                        </div>
                    `;
                }).join('');
            
            document.getElementById('performanceAwards').innerHTML = performanceHTML;
            document.getElementById('funAwards').innerHTML = funHTML;
        }

        function updateRivalries() {
            function h2h(a, b) {
                let aWins = 0, bWins = 0, ties = 0, meetings = 0;
                Object.values(gameData).forEach(gw => {
                    if (!gw.players.includes(a) || !gw.players.includes(b)) return;
                    const positions = {};
                    gw.results.forEach((res, idx) => positions[res.name] = idx + 1);
                    if (positions[a] && positions[b]) {
                        meetings++;
                        if (positions[a] < positions[b]) aWins++;
                        else if (positions[b] < positions[a]) bWins++;
                        else ties++;
                    }
                });
                return { aWins, bWins, ties, meetings };
            }

            const rv1 = h2h('Raghu', 'Venky');
            const rv2 = h2h('Bharath', 'Gokul');

            let shubsGames = 0, shubsWinnings = 0;
            Object.values(gameData).forEach(gw => {
                if (!gw.players.includes('Shubs')) return;
                const entry = gw.results.find(r => r.name === 'Shubs');
                if (entry) {
                    shubsGames++;
                    shubsWinnings += entry.prize;
                }
            });

            const rivalryHTML = `
                <div class="rivalry-card">
                    <div class="rivalry-title">Founders Derby: Raghu vs Venky</div>
                    <div class="rivalry-line">
                        In ${rv1.meetings} gameweeks together, Raghu has finished above Venky <b>${rv1.aWins}</b> times, 
                        Venky has finished above Raghu <b>${rv1.bWins}</b> times, with <b>${rv1.ties}</b> draws.
                    </div>
                    <div class="rivalry-sub">
                        GW13 Update: Raghu (2nd) crushes Venky (14th). The gap widens.
                    </div>
                </div>
                <div class="rivalry-card">
                    <div class="rivalry-title">Chaos Classico: Bharath vs Gokul</div>
                    <div class="rivalry-line">
                        When both play, Bharath has beaten Gokul <b>${rv2.aWins}</b> times,  
                        Gokul has beaten Bharath <b>${rv2.bWins}</b> times, with <b>${rv2.ties}</b> ties.
                    </div>
                    <div class="rivalry-sub">
                        GW13 Update: Bharath freezes (20 pts), Gokul cashes (40 pts). Advantage Gokul.
                    </div>
                </div>
                <div class="rivalry-card">
                    <div class="rivalry-title">Shubs vs The Prize Pool</div>
                    <div class="rivalry-line">
                        Shubs has entered <b>${shubsGames}</b> battles and withdrawn a total of <b>‚Çπ${shubsWinnings}</b>.
                    </div>
                    <div class="rivalry-sub">
                        GW13 Update: Sponsoring the pot again with a TC fail. The house always wins.
                    </div>
                </div>
            `;
            document.getElementById('rivalries').innerHTML = rivalryHTML;
        }

        // Initialize
        updateBattle();
    </script>
</body>
</html>
